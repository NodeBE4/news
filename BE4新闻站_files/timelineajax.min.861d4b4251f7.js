function submitToChinaTimeline(){const e="https://chinatimeline.github.io/";var t=document.getElementById("timeline-events"),n=document.getElementById("timeline-form"),l=document.getElementById("timeline-temp");return n.innerHTML="",l.innerHTML="",$("#timeline-temp").load("https://cors-anywhere.herokuapp.com/"+e+" .container",function(n,m,a){if("success"==m){t.innerHTML="";var s=l.getElementsByTagName("h2");for(i=0;i<s.length;i++){var r=s[i],d=document.createElement("span"),c=r.getElementsByTagName("a")[0],o=document.createElement("a");t.appendChild(d),d.appendChild(o),d.classList.add("badge"),d.classList.add("badge-light"),d.classList.add("cell"),o.innerHTML=c.innerHTML;var g=c.href.split("/"),u="getChinaTimelineForm('"+(e+g[g.length-2]+"/")+"')";o.setAttribute("onclick",u)}l.innerHTML=""}else t.innerText="提交页面下载失败，请稍后再试。"}),!0}function getChinaTimelineForm(e){var t=document.getElementById("timeline-form"),n=document.getElementById("timeline-temp");return t.innerHTML="",n.innerHTML="",$("#timeline-temp").load("https://cors-anywhere.herokuapp.com/"+e+" .container",function(e,l,m){if("success"==l){var a=n.getElementsByTagName("form")[0];a.target="_blank",t.appendChild(a);var s=a.getElementsByClassName("comments");for(i=0;i<s.length;i++){var r=s[i];r.classList.remove("col-6"),r.classList.remove("col-s-6"),r.classList.add("col-12"),r.classList.add("col-s-12")}a.getElementsByTagName("textarea")[0].setAttribute("style","width:100%;"),fillChinaTimelineForm()}else t.innerText="提交页面下载失败，请稍后再试。";n.innerHTML=""}),!0}function fillChinaTimelineForm(){var e=document.getElementById("chan_items").childNodes.length;if(e<1)return False;var t=0;for(i=0;i<e;i++){var n=document.getElementById("article-"+i);document.getElementById("side-"+i);"block"==n.style.display&&(t=i)}n=document.getElementById("article-"+t);var l=document.getElementById("item_title-"+t),m=document.getElementById("news-"+t),a=document.getElementById("item_link-"+t),s=n.getElementsByTagName("img"),r=n.getElementsByTagName("span")[0].innerText.substring(4,14);document.getElementsByName("fields[title]")[0].value=l.innerText,document.getElementsByName("fields[event]")[0].value=m.innerText.substring(0,200),a.href&&(document.getElementsByName("fields[url]")[0].value=a.href),s&&(document.getElementsByName("fields[image]")[0].value=s[0].src),r&&(document.getElementsByName("fields[date]")[0].value=r)}
